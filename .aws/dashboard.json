{
  "widgets": [
    {
      "height": 6,
      "width": 9,
      "y": 0,
      "x": 15,
      "type": "metric",
      "properties": {
        "metrics": [
          [
            {
              "expression": "100*((m3-m1)/m3)",
              "label": "Squidex Observed Uptime",
              "id": "e1",
              "yAxis": "right",
              "region": "us-east-1"
            }
          ],
          [
            "AWS/X-Ray",
            "ApproximateTraceCount",
            "GroupName",
            "SquidexErrors",
            { "id": "m1" }
          ],
          ["...", "SquidexHighLatency", { "id": "m2" }],
          ["...", "SquidexTraces", { "id": "m3", "visible": false }]
        ],
        "view": "timeSeries",
        "stacked": false,
        "region": "us-east-1",
        "title": "Squidex Responses",
        "period": 900,
        "stat": "Sum"
      }
    },
    {
      "height": 6,
      "width": 6,
      "y": 0,
      "x": 0,
      "type": "metric",
      "properties": {
        "metrics": [
          [
            {
              "expression": "100*((m5-m4)/m5)",
              "label": "Api Gateway Uptime",
              "id": "e2",
              "region": "us-east-1",
              "period": 3600
            }
          ],
          [
            {
              "expression": "100*((m2-m1)/m2)",
              "label": "Squidex Uptime (observed)",
              "id": "e1",
              "stat": "Sum",
              "region": "us-east-1",
              "period": 3600
            }
          ],
          [
            "AWS/X-Ray",
            "ApproximateTraceCount",
            "GroupName",
            "SquidexErrors",
            { "id": "m1", "visible": false }
          ],
          ["...", "SquidexTraces", { "id": "m2", "visible": false }],
          [
            "AWS/ApiGateway",
            "4xx",
            "ApiId",
            "5dwpquzdh6",
            { "id": "m3", "visible": false }
          ],
          [".", "5xx", ".", ".", { "id": "m4", "visible": false }],
          [".", "Count", ".", ".", { "id": "m5", "visible": false }]
        ],
        "view": "singleValue",
        "region": "us-east-1",
        "period": 3600,
        "stat": "Sum",
        "title": "Uptime",
        "setPeriodToTimeRange": true,
        "sparkline": false
      }
    },
    {
      "height": 6,
      "width": 9,
      "y": 0,
      "x": 6,
      "type": "metric",
      "properties": {
        "metrics": [
          ["AWS/ApiGateway", "5xx", "ApiId", "5dwpquzdh6"],
          [".", "4xx", ".", "."],
          [".", "Count", ".", "."]
        ],
        "view": "timeSeries",
        "stacked": false,
        "region": "us-east-1",
        "stat": "Sum",
        "period": 300,
        "title": "Production Api Gateway"
      }
    },
    {
      "height": 6,
      "width": 12,
      "y": 6,
      "x": 0,
      "type": "metric",
      "properties": {
        "metrics": [
          [
            {
              "expression": "SELECT AVG(Duration)\nFROM SCHEMA(\"AWS/Lambda\", FunctionName)\nGROUP BY FunctionName\nORDER BY MAX() DESC\nLIMIT 10",
              "label": "${LABEL} [avg: ${AVG}]",
              "id": "q1"
            }
          ]
        ],
        "view": "timeSeries",
        "stacked": false,
        "region": "us-east-1",
        "stat": "Average",
        "period": 300,
        "title": "Top 10 Lambda functions by slowest speed",
        "yAxis": {
          "left": {
            "label": "Milliseconds",
            "showUnits": false
          }
        }
      }
    },
    {
      "height": 6,
      "width": 12,
      "y": 6,
      "x": 12,
      "type": "metric",
      "properties": {
        "view": "timeSeries",
        "stacked": false,
        "metrics": [
          [
            {
              "expression": "SELECT SUM(Errors)\nFROM SCHEMA(\"AWS/Lambda\", FunctionName)\nGROUP BY FunctionName\nORDER BY SUM() DESC\nLIMIT 10",
              "label": "${LABEL} [sum: ${SUM}]",
              "id": "q1"
            }
          ]
        ],
        "region": "us-east-1",
        "title": "Top 10 Lambda functions by error count",
        "yAxis": {
          "left": {
            "label": "Count",
            "showUnits": false
          }
        },
        "stat": "Average",
        "period": 300
      }
    }
  ]
}
